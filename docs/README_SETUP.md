# Инструкция по настройке

## Установка зависимостей

```bash
# Создайте виртуальное окружение (если еще не создано)
python3 -m venv venv

# Активируйте виртуальное окружение
source venv/bin/activate  # для macOS/Linux
# или
venv\Scripts\activate  # для Windows

# Установите зависимости
pip install -r requirements.txt
```

## Настройка Google Drive API

**ВАЖНО**: Без настройки Google Drive API приложение не сможет работать!

Подробная пошаговая инструкция находится в файле **SETUP_INSTRUCTIONS.md**

### Краткая инструкция:

Есть два способа авторизации:

**Способ 1: Service Account (рекомендуется, полностью автоматический)**
- Создайте проект в Google Cloud Console
- Включите Google Drive API
- Создайте Service Account и скачайте JSON ключ
- Сохраните как `service_account.json` в папке проекта
- Поделитесь папкой Google Drive с email адресом Service Account

**Способ 2: OAuth 2.0 (требует авторизацию один раз)**
- Создайте проект в Google Cloud Console
- Включите Google Drive API
- Создайте OAuth 2.0 credentials (Desktop application)
- Скачайте `credentials.json` и поместите в папку проекта
- При первом запуске откроется браузер для авторизации

## Запуск

```bash
python main.py
```

Приложение будет:
- Скачивать Excel файлы с Google Drive
- Парсить данные (после 3 вкладок, до "УП технической разработки")
- Сохранять в SQLite базу данных
- Автоматически обновлять данные каждые 15 минут
- Выводить в консоль примеры данных по каждой группе

## Структура базы данных

- `groups` - группы студентов
- `students` - студенты
- `subjects` - предметы
- `grades` - оценки/пропуски

## Настройки

Все настройки находятся в файле `config.py`:
- `GOOGLE_DRIVE_FOLDER_ID` - ID папки на Google Drive
- `TARGET_FILES` - список файлов для парсинга
- `SKIP_FIRST_SHEETS` - количество пропускаемых вкладок (по умолчанию 3)
- `STOP_SHEET_NAME` - название вкладки для остановки парсинга
- `DATABASE_URL` - URL базы данных (по умолчанию SQLite)
- `PARSE_INTERVAL_MINUTES` - интервал обновления в минутах (по умолчанию 15)

## Формат вывода

Приложение выводит в консоль:
- Для каждой группы: 1 предмет (первый найденный)
- Для каждого предмета: до 5 студентов с их оценками/пропусками
- Формат: Группа → Предмет → ФИО → Дата → Оценка/Пропуск

## Примечания

- Файлы скачиваются во временную папку и автоматически удаляются после парсинга
- База данных SQLite создается автоматически при первом запуске
- Для остановки приложения нажмите Ctrl+C

